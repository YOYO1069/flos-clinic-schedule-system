# FLOS 排班系統 + 考勤管理整合開發

## 專案目標
在現有排班系統中整合考勤管理功能,使用 Supabase 資料庫,部署到 Netlify

## 階段一:分析排班系統架構與設計資料庫
- [x] 分析現有排班系統程式碼結構
- [x] 查看現有 Supabase 資料表
- [x] 設計考勤相關資料表結構
- [x] 規劃功能模組架構

## 階段二:建立考勤系統資料表
- [x] 建立 attendance_records (打卡記錄表)
- [x] 建立 leave_requests (請假申請表)
- [x] 建立 overtime_requests (加班申請表)
- [x] 建立 salary_records (薪資記錄表)
- [x] 設定資料表關聯與索引
- [x] 配置 Row Level Security (RLS)

## 階段三:開發考勤管理功能模組
- [x] 開發打卡功能
  - [x] GPS 定位打卡
  - [x] 上下班打卡記錄
  - [x] 打卡歷史查詢
- [x] 開發出勤記錄管理
  - [x] 出勤記錄列表
  - [x] 異常出勤標記
  - [x] 出勤統計報表
- [x] 開發請假管理
  - [x] 請假申請表單
  - [x] 請假記錄查詢
  - [x] 主管審核介面
- [ ] 開發加班管理
  - [ ] 加班申請
  - [ ] 加班記錄
  - [ ] 加班費計算
- [ ] 開發薪資計算
  - [ ] 自動計算薪資
  - [ ] 薪資明細查詢
  - [ ] 薪資報表匯出
- [ ] 開發數據報表
  - [ ] 出勤統計圖表
  - [ ] 員工考勤分析

## 階段四:測試與部署
- [ ] 功能測試
- [ ] 資料庫讀寫測試
- [ ] 與排班系統整合測試
- [ ] 部署到 Netlify
- [ ] 驗證線上功能

## 階段五:交付
- [ ] 提供部署網址
- [ ] 提供整合說明文件
- [ ] 確認所有功能正常運作


## 階段六:員工登入與分級權限系統
- [x] 建立使用者資料表(users)
- [x] 設定四個職等:管理者、高階主管、一般主管、員工
- [x] 初始化 17 位員工資料和預設密碼
- [x] 實作登入頁面
- [x] 實作登入驗證和 Session 管理
- [x] 實作權限控制中介層
- [x] 根據職等顯示不同功能
- [x] 管理者主控台(查看所有人密碼)
- [x] 員工之間不顯示職等資訊
- [ ] 測試所有職等的登入和權限
- [ ] 部署更新到 Netlify

## 階段七:主管審核請假介面
- [x] 設計審核請假頁面
- [x] 實作權限過濾(高階主管看所有,一般主管看員工)
- [x] 顯示請假申請列表
- [x] 實作審核通過/拒絕功能
- [x] 顯示審核歷史記錄
- [ ] 測試不同職等的審核權限
- [x] 修正 Netlify 部署配置(改用 pnpm)
- [ ] 確認 Netlify 成功部署(等待中)


## 階段八:整合 LINE Bot 打卡系統
- [x] 分析 LINE Bot 打卡系統資料庫結構
- [x] 在 Supabase 建立打卡記錄資料表
- [x] 實作網頁打卡功能(上班/下班)
- [x] 整合 LINE Bot 打卡記錄到網頁顯示
- [x] 確保兩種打卡方式統一儲存
- [ ] 測試雙軌打卡功能
- [ ] 修正 Netlify 建置腳本問題
- [ ] 確認 client/dist 目錄正確生成


## 階段九:月曆表格式排班系統重構
- [ ] 將排班介面改為月曆表格式(類似 Google Calendar)
- [ ] 每個日期格子顯示當日排班員工
- [ ] 支援拖拉方式調整排班
- [ ] 月份切換功能(上一月/下一月)
- [ ] 顯示當月所有員工的休假狀態
- [ ] 在月曆上標示員工請假日期(不同假別不同顏色)
- [ ] 點擊日期可查看該日所有請假員工
- [ ] 支援批量審核請假申請
- [ ] 支援多種班別設定(早班/中班/晚班/休假)
- [ ] 自動檢查排班衝突
- [ ] 排班範本功能
- [ ] 匯出月度排班表為 PDF/Excel
- [ ] 主管可在月曆上直接審核請假
- [ ] 請假衝突提醒(人力不足警告)
- [ ] 請假歷史記錄查詢

## 階段十:登入問題修正
- [x] 診斷 Supabase API Key 問題
- [x] 更新 Netlify 環境變數
- [x] 修正 client/src/lib/supabase.ts 配置
- [x] 直接在程式碼中寫死 Supabase 配置
- [x] 測試登入功能正常運作
- [x] 確認 16 位員工資料完整
